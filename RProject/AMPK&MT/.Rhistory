rm(list = ls())
setwd('E:\scleraBioinformaticsAnalysis\Datasets\3_Myopia_Tissues\High\GSE200053')
rm(list = ls())
setwd('E:/scleraBioinformaticsAnalysis/Datasets/3_Myopia_Tissues/High/GSE200053')
library(tidyverse)
exp <- data.table::fread("GSE309139_raw_counts.txt",header = T)
exp <- data.table::fread("GSE200053_mRNA_sclera_normalized_counts",header = T)
exp <- data.table::fread("GSE200053_mRNA_sclera_normalized_counts.txt",header = T)
table(is.na(exp))
exp[is.na(exp)] <- 0
table(is.na(exp))
exp <- column_to_rownames(exp,var ='Gene')
View(exp)
table(is.na(exp))
exp[is.na(exp)] <- 0
table(is.na(exp))
exp <- column_to_rownames(exp,var ='Gene Symbol')
install.packages("GEOquery]")
install.packages("GEOquery")
install.packages("BiocManager")
library(GEOquery)
BiocManager::install("GEOquery")
library(GEOquery)
library(tidyverse)
gset <- getGEO("GSE200053", destdir = ".", AnnotGPL = F, getGPL = F)
class(gset)
View(gset)
gset[[1]]
exp <- exprs(gset[[1]])
boxplot(exp, outline=F,las=2)
View(exp)
exp <- data.table::fread("GSE200053_mRNA_sclera_normalized_counts.txt",header = T)
boxplot(exp, outline=F,las=2)
GPL <- getGEO(filename = 'GPL17021_family.soft.gz',destdir ='.')
gpl <- GPL@dataTable@table
View(gpl)
colnames(gpl)
View(GPL)
View(GPL)
View(GPL)
GPL@header[["molecule_ch1"]]
GPL@dataTable@table[["GEO Series"]]
class(GPL)
names(Meta(GPL))
GPL <- getGEO(filename = 'GPL17021_family.soft.gz',destdir ='.')
names(Meta(GPL))
[1] "biomaterial_provider_ch1" "channel_count"            "characteristics_ch1"
exp <- data.table::fread("GSE200053_mRNA_sclera_normalized_counts.txt",header = T)
View(exp)
View(exp)
exp <- column_to_rownames(exp,var ='Gene Symbol')
View(exp)
sample_id <- colnames(exp)
sample_idgroup <- rep(c('L','HLL','HL'),each=6)
group
sample_id <- colnames(exp)
sample_id
group <- rep(c('L','HLL','HL'),each=6)
group
rt <- data.frame(row.names =sample_id,group=group)
exp[6]
exp[8:18]
exp[8:17]
exp <- exp[8:17]
exp <- exp %>% select(TB61SL,TB61SR,TB64SL,TB64SR,TB65SL,TB65SR,TB66SL,TB66SR,TB68SL,TB68SR)
sample_id <- colnames(exp)
group <- rep(c('61','64','65','66','68'),each=2)
rt <- data.frame(row.names =sample_id,group=group)
identical(rownames(rt),colnames (exp))
BiocManager::install('DESeg2')
library(DEseq2)
BiocManager::install('DESeg2')
BiocManager::install('DESeg2')
BiocManager::install('DESeq2')
library(DEseq2)
BiocManager::install('DESeq2')
BiocManager::install('DESeq2',force = true)
BiocManager::install('DESeq2',force = TRUE)
library(DEseq2)
library(DESeq2)
rt$group <- factor(rt$group)
rt
rt$group
dds <- DESeqDataSetFromMatrix(
countData = exp,
colData = rt,
design = ~ group
)
range(exp, na.rm = TRUE)
summary(as.numeric(exp))
range(exp, na.rm = TRUE)
summary((exp))
range(exp, na.rm = TRUE)
exp
View(exp)
exp <- exp %>% select(TB61SL,TB64SL,TB65SL,TB66SL,TB68SL,TB61SR,TB65SR,TB65SR,TB66SR,TB68SR)
exp <- data.table::fread("GSE200053_mRNA_sclera_normalized_counts.txt",header = T)
exp <- column_to_rownames(exp,var ='Gene Symbol')
exp <- exp[8:17]
exp <- exp %>% select(TB61SL,TB64SL,TB65SL,TB66SL,TB68SL,TB61SR,TB64SR,TB65SR,TB66SR,TB68SR)
sample_id <- colnames(exp)
group <- rep(c('L','R'),each=5)
rt <- data.frame(row.names =sample_id,group=group)
identical(rownames(rt),colnames (exp))
rt$group <- factor(rt$group)
View(exp)
str(exp)
exp <- log2(exp + 1)
View(exp)
range(exp)
group_list <-factor(rt$group,levels = c("R","L"))
group_list <-factor(rt$group,levels = c("L","R"))
design <- model.matrix(~group_list)
fit <- lmFit(exp,design)
library(limma)
library(pheatmap)
library(tidyverse)
library(ggpubr)
fit <- lmFit(exp,design)
View(fit)
fit2 <- eBayes(fit)
deg <- topTable(fit2, coef = 2, number = Inf)
View(deg)
DEG = na.omit(deg)
geneswrite.table(DEG, file='DEG1.txt',sep = "\t",row.names = T,col.names = NA, quote = F)
write.table(DEG, file='DEG1.txt',sep = "\t",row.names = T,col.names = NA, quote = F)
logFC_cutoff <- 1
typel = (DEG$adj.P.Val < 0.05)&(DEG$logFC < -logFC_cutoff)
type2 = (DEG$adj.P.Val < 0.05)&(DEG$logFC > logFC_cutoff)
DEG$change = ifelse (typel, "DOWN", ifelse (type2, "UP", "NOT"))
View(DEG)
logFC_cutoff <- 0.4
typel = (DEG$adj.P.Val < 0.05)&(DEG$logFC < -logFC_cutoff)
type2 = (DEG$adj.P.Val < 0.05)&(DEG$logFC > logFC_cutoff)
DEG$change = ifelse (typel, "DOWN", ifelse (type2, "UP", "NOT"))
logFC_cutoff <- 1
type1 = (DEG$adj.P.Val < 0.05)&(DEG$logFC < -logFC_cutoff)
type2 = (DEG$adj.P.Val < 0.05)&(DEG$logFC > logFC_cutoff)
DEG$change = ifelse (type1, "DOWN", ifelse (type2, "UP", "NOT"))
write.table(DEG, file='DEG2.txt',sep = "\t",row.names = T,col.names = NA, quote = F)
logFC_cutoff <- 0.3
type1 = (DEG$adj.P.Val < 0.05)&(DEG$logFC < -logFC_cutoff)
type2 = (DEG$adj.P.Val < 0.05)&(DEG$logFC > logFC_cutoff)
DEG$change = ifelse (type1, "DOWN", ifelse (type2, "UP", "NOT"))
logFC_cutoff <- 0.3
type1 = (DEG$P.Val < 0.05)&(DEG$logFC < -logFC_cutoff)
type2 = (DEG$P.Val < 0.05)&(DEG$logFC > logFC_cutoff)
DEG$change = ifelse (type1, "DOWN", ifelse (type2, "UP", "NOT"))
write.table(DEG, file='DEG2.txt',sep = "\t",row.names = T,col.names = NA, quote = F)
table(DEG$change)
library(ggplot2)
library(cowplot)
library(ggrepel)
view(DEg)
view(DEG)
DEG <- mutate(DEG,Gene_symbol=row.names (DEG))
UPDEG <- subset (DEG,change=='UP')
UPDEG_5 <- top_n(x = UPDEG,n = -5,wt = P.Value)
DOWNDEG <- subset (DEG, change=='DOWN')
DOWNDEG_5 <- top_n(x = DOWNDEG,n = -5,wt = P.Value)
p <- ggplot(data = DEG,
aes(x = logFC,y = -log10(adj.P.Val))) +
geom_point(alpha = 0.5, size = 4.5,
aes(color = change)) +
ylab("-log10(adj.P.Val)") +
scale_color_manual(values = c("#1F77B4","grey","#FF7F0E"))
install.packages("rlang")
packageVersion("rlang")
packageVersion("ggplot2")
sessionInfo()
packageVersion("rlang")
packageVersion("ggplot2")
library(ggplot2)
ggplot(mtcars, aes(mpg, wt)) +
geom_point() +
geom_vline(xintercept = 20)
